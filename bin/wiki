#!/bin/sh
DIR=$HOME/.local/share/wiki

# todo: use ip route
NETWORK=$(LANG=en_US.UTF-8 ifconfig | grep 'inet addr' | grep -vF 127.0.0.1 | wc -l)

if [ -d "$DIR" ]; then
  cd $DIR
  if [ ${NETWORK} != "0" ]; then
	  git pull -q
  fi
  if [ -z "$1" ]; then
    PAGE="index.txt"
  else
    PAGE=$(find . -iname $1)
    if [ -z "$PAGE" ]; then
      PAGE="$1"
    fi
  fi
  vim $PAGE && git add . && git ci . -m "autocommit by wiki"
  if [ ${NETWORK} != "0" ]; then
	  git push
  fi
else
  echo "$DIR does not exist."
  exit 1
fi

